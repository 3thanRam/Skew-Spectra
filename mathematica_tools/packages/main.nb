(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29784,        651]
NotebookOptionsPosition[     27834,        613]
NotebookOutlinePosition[     28268,        630]
CellTagsIndexPosition[     28225,        627]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\"\<Global`*\>\"", ",", "\"\<globalvars`*\>\"", ",", 
      "\"\<quadfcts`*\>\"", ",", "\"\<util`*\>\"", ",", "\"\<fftlog`*\>\"", 
      ",", "\"\<fftlogdiv`*\>\"", ",", "\"\<losintegrals`*\>\"", ",", 
      "\"\<losintcalcs`*\>\"", ",", "\"\<biasreduction`*\>\"", ",", 
      "\"\<savefcts`*\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Import", " ", "packages", " ", 
     RowBox[{"using", " ", ".", "m"}], " ", "files", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Current", " ", ".", "nb"}], " ", "files", " ", "automatically", 
     " ", 
     RowBox[{"generate", " ", ".", "m"}], " ", "files", " ", "when", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "stores", " ", "and", " ", "shared", " ", "variables", " ", "across", " ",
      "files"}], "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<globalvars.m\>\""}],
      "]"}], " ", ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Quadratic", " ", "kernels", " ", "and", " ", "operators"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<quadfcts.m\>\""}], 
     "]"}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"custom", " ", "simplify", " ", "function"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<util.m\>\""}], 
     "]"}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"fftlog", " ", "operations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<fftlog.m\>\""}], 
     "]"}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{"(*", 
    RowBox[{
    "master", " ", "and", " ", "line", " ", "of", " ", "sight", " ", 
     "integrals"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<losintegrals.m\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"call", " ", "necessary", " ", 
     RowBox[{"l", ".", "o", ".", "s"}], " ", "integral", " ", "and", " ", 
     "functions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<losintcalcs.m\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "optimise", " ", "number", " ", "of", " ", "fftlog", " ", "biases", " ", 
     "and", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<biasreduction.m\>\""}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "to", " ", "save", " ", "final", " ", "results", " ", "to", " ", "be", 
     " ", "used", " ", "in", " ", "c", " ", "code"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<savefcts.m\>\""}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cosmological", " ", "biases"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"csts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b1", "^", "3"}], ",", 
       RowBox[{
        RowBox[{"b1", "^", "2"}], " ", "b2"}], ",", 
       RowBox[{
        RowBox[{"b1", "^", "2"}], " ", "bg2"}], ",", 
       RowBox[{"f", " ", 
        RowBox[{"b1", "^", "3"}]}], ",", " ", 
       RowBox[{"f", " ", 
        RowBox[{"b1", "^", "2"}]}], ",", 
       RowBox[{"f", " ", "b1", " ", "b2"}], ",", 
       RowBox[{"f", " ", "b1", " ", "bg2"}], ",", 
       RowBox[{
        RowBox[{"f", "^", "2"}], " ", 
        RowBox[{"b1", "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"f", "^", "2"}], " ", "b1"}], ",", 
       RowBox[{
        RowBox[{"f", "^", "2"}], " ", "b2"}], ",", " ", 
       RowBox[{
        RowBox[{"f", "^", "2"}], " ", "bg2"}], ",", 
       RowBox[{
        RowBox[{"f", "^", "3"}], " ", "b1"}], ",", 
       RowBox[{"f", "^", "3"}], ",", 
       RowBox[{"f", "^", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cstM", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "csts", "}"}], "]"}], ".", 
      RowBox[{"{", "csts", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "vector", " ", "of", " ", "different", " ", "quadratic", " ", "operators",
      " ", "at", " ", "Di", 
     RowBox[{"(", 
      RowBox[{"q", ",", 
       RowBox[{"k", "-", "q"}]}], ")"}], " ", "and", " ", "Di", 
     RowBox[{"(", 
      RowBox[{"q", ",", 
       RowBox[{"-", "k"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dvec", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Dfunc", "[", 
        RowBox[{"i", ",", "q", ",", 
         RowBox[{"k", "-", "q"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Dvec2", "=", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"Dfunc", "[", 
        RowBox[{"i", ",", "q", ",", 
         RowBox[{"-", "k"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "matrix", " ", "representing", " ", "product", " ", "of", " ", "vectors", 
     " ", "for", " ", "symmetric", " ", "and", " ", "unsymmetric", " ", 
     "integrations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sym", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "Dvec", "}"}], "]"}], ".", 
      RowBox[{"{", "Dvec", "}"}]}]}], ";", " ", 
    RowBox[{"unsym", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "Dvec", "}"}], "]"}], ".", 
      RowBox[{"{", "Dvec2", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "decomposition", " ", "into", " ", "powers", " ", "of", " ", "k"}], ",", 
     "q", ",", 
     RowBox[{
     "kmq", " ", "and", " ", "muq", " ", "then", " ", "writing", " ", 
      "result", " ", "of", " ", "integration", " ", "using", " ", "master", 
      " ", "and", " ", "line", " ", "of", " ", "sight", " ", "integrals"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tlos", "=", 
     RowBox[{
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"symlos", "=", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q0kmqmuqdecomp", "[", "#", "]"}], "&"}], ",", "sym", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"unsymlos", "=", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q0kmqmuqdecomp", "[", "#", "]"}], "&"}], ",", "unsym", 
           ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<LOS time: \>\"", ",", "tlos"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"integration", " ", "over", " ", "muk"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symMatr", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"muk", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
       "symlos", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"unsymMatr", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"muk", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
       "unsymlos", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.928911509288562*^9, 3.928911641689958*^9, 3.928911698035798*^9, {
   3.928911980070599*^9, 3.928912004719852*^9}, {3.928912371572884*^9, 
   3.928912386396294*^9}, {3.928912464554966*^9, 3.928912485044203*^9}, {
   3.928912518574508*^9, 3.928912568503017*^9}, {3.928912654012082*^9, 
   3.928912683190314*^9}, 3.928912770154046*^9, {3.928912812064715*^9, 
   3.928912835022648*^9}, {3.928912879039446*^9, 3.928912900013562*^9}, {
   3.928912930014671*^9, 3.9289129306194887`*^9}, {3.9289130712891*^9, 
   3.928913088203163*^9}, 3.928913243567306*^9, {3.92891329651512*^9, 
   3.9289133260062304`*^9}, {3.928913396652684*^9, 3.928913399274702*^9}, {
   3.9289135734810057`*^9, 3.928913584480731*^9}, {3.928913652575168*^9, 
   3.92891370577986*^9}, {3.928913737006754*^9, 3.928913743869945*^9}, {
   3.928913781610935*^9, 3.928913794999034*^9}, {3.928913936535445*^9, 
   3.928913964197403*^9}, {3.928914032525081*^9, 3.92891407459299*^9}, 
   3.928914136615515*^9, {3.9289143796788177`*^9, 3.928914411435554*^9}, {
   3.928914874326609*^9, 3.928914875185646*^9}, 3.9289149204996223`*^9, {
   3.928914987867245*^9, 3.928914990151543*^9}, {3.928915083776996*^9, 
   3.92891508669351*^9}, 3.928915131144166*^9, {3.928915441771006*^9, 
   3.928915513682335*^9}, {3.928915812278685*^9, 3.928915827393931*^9}, {
   3.928915896670536*^9, 3.928915914271544*^9}, 3.9289160444725246`*^9, {
   3.928916260808378*^9, 3.92891626927985*^9}, {3.928916434873316*^9, 
   3.928916448733829*^9}, {3.928916707188333*^9, 3.928916723852056*^9}, {
   3.928916962053899*^9, 3.928916963585052*^9}, {3.928916998435442*^9, 
   3.928917004085107*^9}, {3.928917335758338*^9, 3.928917338876299*^9}, {
   3.928917425694207*^9, 3.928917431943775*^9}, 3.928917480711231*^9, {
   3.928917519092903*^9, 3.928917528041204*^9}, 3.92891757229976*^9, {
   3.928917604123024*^9, 3.928917607354205*^9}, 3.928917832277088*^9, {
   3.928917867590073*^9, 3.92891786996602*^9}, {3.928917919898622*^9, 
   3.928917948590962*^9}, {3.928918051791172*^9, 3.92891805482393*^9}, 
   3.92891817360821*^9, 3.9289183796101103`*^9, 3.928920124185813*^9, {
   3.928920175847777*^9, 3.928920190361779*^9}, {3.928920473668249*^9, 
   3.928920476592595*^9}, {3.92892053642907*^9, 3.92892058094382*^9}, {
   3.928920650464298*^9, 3.928920660873995*^9}, {3.928920706277614*^9, 
   3.928920710659939*^9}, {3.928920846999549*^9, 3.928920860032084*^9}, {
   3.928920972560989*^9, 3.928921003191187*^9}, {3.928921038341379*^9, 
   3.928921044516673*^9}, {3.928921082615937*^9, 3.928921256964457*^9}, {
   3.928921340484432*^9, 3.92892136758928*^9}, {3.928921400538273*^9, 
   3.928921403882248*^9}, {3.928921481521328*^9, 3.928921483551512*^9}, {
   3.928921558785713*^9, 3.928921580468442*^9}, {3.928921626405072*^9, 
   3.928921638321553*^9}, {3.928921684983642*^9, 3.928921691772898*^9}, {
   3.928921771735056*^9, 3.928921775542612*^9}, {3.928921974212797*^9, 
   3.928921988428768*^9}, {3.9289220327536*^9, 3.92892206950169*^9}, 
   3.928922146389571*^9, {3.928922246653774*^9, 3.928922251136022*^9}, {
   3.9289223432287188`*^9, 3.928922488145954*^9}, {3.928922563449679*^9, 
   3.9289225734207783`*^9}, {3.92892264426661*^9, 3.9289226618494*^9}, {
   3.928922694072891*^9, 3.928922726376502*^9}, {3.9289230912972097`*^9, 
   3.928923131857963*^9}, {3.928924038749208*^9, 3.928924067048547*^9}, 
   3.928924146922134*^9, 3.928980869589713*^9, {3.928981621269071*^9, 
   3.928981664182702*^9}, 3.928981771066255*^9, {3.928981821915495*^9, 
   3.928981862267774*^9}, {3.928981929489479*^9, 3.9289820051047907`*^9}, {
   3.9289821632349157`*^9, 3.92898219112359*^9}, {3.92898238053767*^9, 
   3.928982444843603*^9}, {3.928984139177084*^9, 3.928984146111475*^9}, 
   3.928985439038386*^9, 3.928985638170913*^9, {3.928985790747902*^9, 
   3.9289858006408997`*^9}, {3.928986536530839*^9, 3.928986577507518*^9}, {
   3.9289866204043417`*^9, 3.928986621703041*^9}, {3.928986768144856*^9, 
   3.928986872394804*^9}, {3.928986943243739*^9, 3.928986997096746*^9}, {
   3.9289870843428802`*^9, 3.928987123432318*^9}, {3.92898721528904*^9, 
   3.928987496397558*^9}, {3.92898755291884*^9, 3.928987624383492*^9}, {
   3.928987670595772*^9, 3.92898774344505*^9}, {3.9290883166314793`*^9, 
   3.929088319918737*^9}, {3.929088793291374*^9, 3.929088802306004*^9}, 
   3.929088838431405*^9, {3.9290888775000772`*^9, 3.929088935979665*^9}, 
   3.929095277672666*^9, {3.929095307945736*^9, 3.929095318261589*^9}, {
   3.929095377196594*^9, 3.929095429297596*^9}, 3.929095835080235*^9, {
   3.929095904149786*^9, 3.92909590819624*^9}, {3.929096671077999*^9, 
   3.929096694988452*^9}, 3.929096765073475*^9, {3.929096818457034*^9, 
   3.929096892524935*^9}, {3.929096937158216*^9, 3.929097028051264*^9}, {
   3.929097063504952*^9, 3.929097123787017*^9}, {3.929097175299885*^9, 
   3.9290972198305902`*^9}, {3.9296134439860487`*^9, 3.929613490396861*^9}, {
   3.929613604004143*^9, 3.929613604380396*^9}, {3.929614725238036*^9, 
   3.929614738617659*^9}, {3.929614837921441*^9, 3.929614912731433*^9}, {
   3.929615183872851*^9, 3.9296152268645067`*^9}, {3.929615411115585*^9, 
   3.929615443436618*^9}, {3.929694994761614*^9, 3.929695029425103*^9}, {
   3.929695793467318*^9, 3.929695797954769*^9}, {3.929695849665929*^9, 
   3.929695858618389*^9}, {3.929698045720316*^9, 3.929698223307016*^9}, {
   3.9296989743499937`*^9, 3.9296989853855333`*^9}, {3.929699283751621*^9, 
   3.929699285582123*^9}, {3.929699417459854*^9, 3.929699424321635*^9}, {
   3.929699458211419*^9, 3.9296994611280193`*^9}, {3.929699518474921*^9, 
   3.929699772302967*^9}, {3.9296999342111387`*^9, 3.929699934227766*^9}, 
   3.929699981536391*^9, {3.929700046998065*^9, 3.929700166352315*^9}, {
   3.929700204485219*^9, 3.929700225887172*^9}, {3.929700269300324*^9, 
   3.929700319583707*^9}, {3.929700528770315*^9, 3.929700548437818*^9}, {
   3.929700589967233*^9, 3.929700595064903*^9}, {3.929700634729953*^9, 
   3.929700731850628*^9}, {3.929700781410434*^9, 3.9297008700441628`*^9}, {
   3.929700957714065*^9, 3.929700958007162*^9}, {3.929701044106979*^9, 
   3.92970106155366*^9}, {3.929701142926216*^9, 3.929701240642938*^9}, {
   3.929701274453163*^9, 3.929701276984095*^9}, {3.929701349115875*^9, 
   3.9297013650626698`*^9}, 3.929701446205887*^9, {3.929701532168145*^9, 
   3.929701554448842*^9}, {3.929701599709854*^9, 3.92970164034703*^9}, {
   3.929701700384589*^9, 3.929701779315188*^9}, {3.929702094723104*^9, 
   3.929702105768373*^9}, {3.929759218521357*^9, 3.929759229093225*^9}, 
   3.9297596259642363`*^9, {3.929760542467108*^9, 3.929760551551877*^9}, {
   3.929760619331283*^9, 3.929760636581751*^9}, 3.9297614429631853`*^9, 
   3.929761637925403*^9, {3.929761793903833*^9, 3.929761820135373*^9}, {
   3.92976200665672*^9, 3.929762008249233*^9}, {3.929762070196785*^9, 
   3.92976208736068*^9}, {3.929762200770298*^9, 3.929762241774551*^9}, {
   3.929762315866806*^9, 3.929762329859725*^9}, 3.929764313474114*^9, {
   3.929764458857511*^9, 3.929764477298865*^9}, 3.929764551451884*^9, {
   3.929764961055434*^9, 3.929764970664632*^9}, 3.929765016014124*^9, {
   3.929765500636664*^9, 3.929765518400996*^9}, {3.929765584872007*^9, 
   3.9297655993072863`*^9}, 3.930486544848518*^9, {3.930486613530343*^9, 
   3.930486614858144*^9}, {3.93049029737508*^9, 3.930490312549232*^9}, {
   3.930490876384366*^9, 3.93049087960636*^9}, {3.930561556369594*^9, 
   3.930561556823125*^9}, {3.93064836201196*^9, 3.93064836926154*^9}, {
   3.930746801017082*^9, 3.930746953093204*^9}, {3.930747297381366*^9, 
   3.9307473733008137`*^9}, {3.930747445047883*^9, 3.930747528677998*^9}, {
   3.930747562123379*^9, 3.930747571792088*^9}, {3.930750517084571*^9, 
   3.930750572999734*^9}, {3.93075062331374*^9, 3.9307509016758137`*^9}, {
   3.930751335577658*^9, 3.930751337050639*^9}, {3.930807148048984*^9, 
   3.930807168227758*^9}, {3.930807846523245*^9, 3.930807882516374*^9}, {
   3.930807958101296*^9, 3.9308080516045933`*^9}, {3.930808102318363*^9, 
   3.930808106512763*^9}},ExpressionUUID->"e1703958-b1a0-40b7-b757-\
dc73ed522ba2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LOS time: \"\>", "\[InvisibleSpace]", "17.330177`"}],
  SequenceForm["LOS time: ", 17.330177],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929699426412386*^9, 3.92969943447586*^9}, 
   3.929699789063057*^9, {3.929700126223753*^9, 3.929700168326658*^9}, {
   3.929700208012377*^9, 3.92970022721742*^9}, {3.929700289233716*^9, 
   3.929700298227433*^9}, 3.9297003297072573`*^9, {3.92970053097793*^9, 
   3.929700550013681*^9}, 3.929700609369419*^9, {3.9297006552892933`*^9, 
   3.929700721072778*^9}, {3.929700795813983*^9, 3.929700871252486*^9}, {
   3.929700948388681*^9, 3.9297010047761497`*^9}, 3.929701050467313*^9, {
   3.929701167200272*^9, 3.929701183833992*^9}, {3.929701222459522*^9, 
   3.929701241330573*^9}, {3.929701278135057*^9, 3.9297012838834877`*^9}, {
   3.92970133559694*^9, 3.929701350587564*^9}, {3.929701387027382*^9, 
   3.929701405621025*^9}, 3.9297014681058273`*^9, 3.9297015435137444`*^9, {
   3.929701621772599*^9, 3.929701642532192*^9}, 3.929701727231419*^9, 
   3.929701785353126*^9, 3.929701820898527*^9, 3.929759237800301*^9, 
   3.9297596286565437`*^9, 3.929759760545743*^9, 3.9297597926252813`*^9, 
   3.929759877760192*^9, 3.929760018368517*^9, 3.929760082289952*^9, 
   3.929760140684335*^9, 3.9297602916346407`*^9, 3.929761168456664*^9, 
   3.929761303472703*^9, 3.929761448426071*^9, 3.9297618300884247`*^9, 
   3.929762100038454*^9, 3.929762243103744*^9, 3.929762331154557*^9, 
   3.9297639476742153`*^9, 3.9297643162619*^9, 3.92976452257436*^9, 
   3.929764552796661*^9, 3.929764892544194*^9, 3.929764973027923*^9, 
   3.929765017913067*^9, 3.929765125843207*^9, 3.92976516320346*^9, 
   3.929765270315246*^9, 3.929765310081336*^9, 3.92976538924552*^9, {
   3.929765502177887*^9, 3.929765525169018*^9}, 3.929854515795807*^9, 
   3.930485776634832*^9, 3.930485836077815*^9, 3.930486470988926*^9, 
   3.930486615910376*^9, 3.930486721817459*^9, 3.930486932200855*^9, 
   3.930487041657283*^9, 3.930489130341901*^9, 3.930490013567801*^9, 
   3.930491007772508*^9, 3.93056053528318*^9, 3.930560572071665*^9, 
   3.9305615043349957`*^9, 3.930561562337914*^9, 3.930561687364328*^9, 
   3.930561802636271*^9, 3.930561887444426*^9, 3.930562618077129*^9, 
   3.930562875007941*^9, 3.930751479758931*^9, 3.930751654896434*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a813cf29-e2d9-4d62-85eb-45e98fce266f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9296152351215677`*^9, 3.92961538283312*^9}},
 CellLabel->
  "In[1618]:=",ExpressionUUID->"1b090470-49e3-4753-b563-77592375f538"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "get", " ", "divergence", " ", "range", " ", "and", " ", "leading", " ", 
    "divergence", " ", "for", " ", "each", " ", "fftlog", " ", "calculation", 
    " ", "for", " ", "symmetric", " ", "and", " ", "unsymmetric", " ", "part",
     "\[IndentingNewLine]", " ", "find", " ", "number", " ", "of", " ", 
    "fftlog", " ", "biases", " ", "and", " ", "values", " ", "that", " ", 
    "minimise", " ", "the", " ", "number", " ", "of", " ", "divergent", " ", 
    "pieces"}], " ", "\[IndentingNewLine]", " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"t5", "=", 
     RowBox[{
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Symdivergences", ",", "UnSymdivergences", ",", "biases"}], 
          "}"}], "=", 
         RowBox[{"reducebiases", "[", 
          RowBox[{"sym", ",", "unsym"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<bias time: \>\"", ",", "t5"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.929761652305943*^9, 3.929761653094442*^9}, 
   3.929765539219401*^9, {3.930751055487248*^9, 3.930751200335037*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"6b8e4353-29bd-4804-a948-6f4eeebf4f16"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm[1, ",", 1],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.930752129119522*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"22794e45-82e0-459f-866f-68542fa102a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm[2, ",", 1],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.9307522007411623`*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"4f89fb48-be90-40e1-8835-8c142e415d4d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm[2, ",", 2],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.930752228816127*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"6324da3b-871e-42d9-af35-87aab0c6e2d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"3", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm[3, ",", 1],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.93075223499328*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"b0835786-94d1-450f-abfe-b042b29b19b0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"3", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm[3, ",", 2],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.930752342476349*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"5fffe079-552d-4fcc-ba26-275192a33872"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.930752362514194*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"4139a6a1-11ae-41ee-86cc-c28800212f48"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bias time: \"\>", "\[InvisibleSpace]", "t5"}],
  SequenceForm["bias time: ", $CellContext`t5],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.930562634580164*^9, 3.93056289573364*^9, 
  3.930751360459968*^9, 3.9307523625161867`*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"b4f19cfb-97bf-40b4-8fd2-ba07ede1e5b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"multiply", " ", "by", " ", "biases", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "only", " ", "done", " ", "at", " ", "the", " ", "end", " ", "since", 
       " ", "the", " ", "symmetry", " ", "of", " ", "the", " ", "symmetric", 
       " ", "part"}], ",", " ", 
      RowBox[{
      "which", " ", "is", " ", "broken", " ", "after", " ", "including", " ", 
       "the", " ", "constants"}], " ", ",", " ", 
      RowBox[{
      "can", " ", "be", " ", "exploited", " ", "to", " ", "reduce", " ", 
       "the", " ", "number", " ", "of", " ", "necessary", " ", 
       "calculations"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"symMatr", "=", 
     RowBox[{"symMatr", "*", "cstM"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"unsymMatr", "=", 
     RowBox[{"unsymMatr", "*", "cstM"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"print", " ", "and", " ", "save", " ", "output"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"savefunc", "[", 
      RowBox[{
      "symMatr", ",", "unsymMatr", ",", "Symdivergences", ",", 
       "UnSymdivergences", ",", "biases"}], "]"}], ";"}], "*)"}]}]}]], "Input",\

 CellChangeTimes->{{3.929762521685955*^9, 3.929762574248687*^9}, {
   3.92976262289322*^9, 3.929762633591404*^9}, 3.929762748327569*^9, {
   3.929762798081235*^9, 3.929762857679187*^9}, {3.929762935259325*^9, 
   3.929762976956208*^9}, {3.929763009261695*^9, 3.929763100806504*^9}, {
   3.929763138856382*^9, 3.929763151573738*^9}, {3.9297631922620087`*^9, 
   3.929763216124057*^9}, {3.929763250538785*^9, 3.929763271433717*^9}, {
   3.929763301744294*^9, 3.929763408909812*^9}, {3.929763470672301*^9, 
   3.929763617035142*^9}, {3.929763703962881*^9, 3.929763713025331*^9}, {
   3.929763743897701*^9, 3.929763792151998*^9}, {3.929763836173612*^9, 
   3.929763875618884*^9}, {3.929765541883951*^9, 3.929765547483796*^9}, {
   3.930490896461052*^9, 3.930490936776469*^9}, 3.930490981989971*^9, {
   3.930751214740622*^9, 3.930751328305965*^9}, {3.930751671880388*^9, 
   3.930751688977885*^9}, {3.930810055954775*^9, 3.930810060810677*^9}, {
   3.9308100939037657`*^9, 3.930810232643992*^9}, {3.9308136057097397`*^9, 
   3.930813612844858*^9}},ExpressionUUID->"e4eada7d-2a87-47a7-87a6-\
04edb307fb08"],

Cell[BoxData["\<\"/home/ethan/Documents/Code/GIT_PROJECTS/Skew-Spectra/\
mathematica_tools/packages/\"\>"], "Output",
 CellChangeTimes->{
  3.93081006191588*^9, {3.930810094792272*^9, 3.930810180270331*^9}, 
   3.930810217017318*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"2d452f28-5bfc-4340-9c21-384463828638"],

Cell[BoxData["\<\"/home/ethan\"\>"], "Output",
 CellChangeTimes->{
  3.93081006191588*^9, {3.930810094792272*^9, 3.930810180270331*^9}, 
   3.930810217018458*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"a369e73c-ea87-48d0-bf66-30bca4c57773"],

Cell[BoxData["\<\"/home\"\>"], "Output",
 CellChangeTimes->{
  3.93081006191588*^9, {3.930810094792272*^9, 3.930810180270331*^9}, 
   3.930810217019622*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"e02996d2-a6e1-4632-81c9-f5d7aed4dfd4"],

Cell[BoxData["\<\"/home/ethan/Documents/Code/GIT_PROJECTS/Skew-Spectra/skew_\
spectra_fftlog\"\>"], "Output",
 CellChangeTimes->{
  3.93081006191588*^9, {3.930810094792272*^9, 3.930810180270331*^9}, 
   3.930810217037784*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"70f76829-1786-4dc9-8ee3-2e977a7944ff"]
}, Open  ]]
},
WindowSize->{1040.25, 564},
WindowMargins->{{95.25, Automatic}, {Automatic, 92.25}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"91af628d-4d34-4f95-865a-7754892d0987"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 16919, 347, 943, "Input",ExpressionUUID->"e1703958-b1a0-40b7-b757-dc73ed522ba2"],
Cell[17502, 371, 2415, 37, 18, "Print",ExpressionUUID->"a813cf29-e2d9-4d62-85eb-45e98fce266f"]
}, Open  ]],
Cell[19932, 411, 177, 3, 23, "Input",ExpressionUUID->"1b090470-49e3-4753-b563-77592375f538"],
Cell[CellGroupData[{
Cell[20134, 418, 1471, 32, 158, "Input",ExpressionUUID->"6b8e4353-29bd-4804-a948-6f4eeebf4f16"],
Cell[CellGroupData[{
Cell[21630, 454, 404, 10, 30, "Print",ExpressionUUID->"22794e45-82e0-459f-866f-68542fa102a9"],
Cell[22037, 466, 406, 10, 30, "Print",ExpressionUUID->"4f89fb48-be90-40e1-8835-8c142e415d4d"],
Cell[22446, 478, 404, 10, 30, "Print",ExpressionUUID->"6324da3b-871e-42d9-af35-87aab0c6e2d5"],
Cell[22853, 490, 403, 10, 30, "Print",ExpressionUUID->"b0835786-94d1-450f-abfe-b042b29b19b0"],
Cell[23259, 502, 404, 10, 30, "Print",ExpressionUUID->"5fffe079-552d-4fcc-ba26-275192a33872"]
}, Open  ]],
Cell[23678, 515, 156, 2, 26, "Output",ExpressionUUID->"4139a6a1-11ae-41ee-86cc-c28800212f48"],
Cell[23837, 519, 412, 10, 30, "Print",ExpressionUUID->"b4f19cfb-97bf-40b4-8fd2-ba07ede1e5b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24286, 534, 2428, 50, 143, "Input",ExpressionUUID->"e4eada7d-2a87-47a7-87a6-04edb307fb08"],
Cell[26717, 586, 312, 5, 26, "Output",ExpressionUUID->"2d452f28-5bfc-4340-9c21-384463828638"],
Cell[27032, 593, 241, 4, 26, "Output",ExpressionUUID->"a369e73c-ea87-48d0-bf66-30bca4c57773"],
Cell[27276, 599, 235, 4, 26, "Output",ExpressionUUID->"e02996d2-a6e1-4632-81c9-f5d7aed4dfd4"],
Cell[27514, 605, 304, 5, 26, "Output",ExpressionUUID->"70f76829-1786-4dc9-8ee3-2e977a7944ff"]
}, Open  ]]
}
]
*)

