(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8862,        211]
NotebookOptionsPosition[      8135,        190]
NotebookOutlinePosition[      8563,        207]
CellTagsIndexPosition[      8520,        204]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<util`\>\"", "]"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplfunc", "::", "usage"}], "=", 
     "\"\<Simplify an expression\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<globalvars.m\>\""}],
      "]"}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"simplify", " ", "an", " ", "expression"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"write", " ", "in", " ", "terms", " ", "of", " ", 
        RowBox[{"{", 
         RowBox[{"q0", ",", "k0", ",", "kmq", ",", "muq", ",", "muk"}], 
         "}"}]}], " ", "&"}], " ", "remove", " ", "phi", " ", 
      "dependence"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplfunc", "[", "expr0_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"exprini", "=", "expr0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"expr", "=", 
         RowBox[{"exprini", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", "k", "]"}], "^", "2"}], "->", 
             RowBox[{"k0", "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", "q", "]"}], "^", "2"}], "->", 
             RowBox[{"q0", "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"k", "-", "q"}], "]"}], "^", "2"}], "->", 
             RowBox[{"kmq", "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{"muk", "^", "2"}]}], "]"}], " ", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{"muq", "^", "2"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", "phi", "]"}]}], "->", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"kmq", "^", "2"}]}], "+", 
                 RowBox[{"k0", "^", "2"}], "+", 
                 RowBox[{"q0", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", "k0", " ", "q0"}], ")"}]}], "-", 
              RowBox[{"muk", " ", "muq"}]}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rationalize", "[", 
            RowBox[{"Simplify", "[", "expr", "]"}], "]"}], "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "phi", "]"}], "->", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"kmq", "^", "2"}]}], "+", 
                    RowBox[{"k0", "^", "2"}], "+", 
                    RowBox[{"q0", "^", "2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "k0", " ", "q0"}], ")"}]}], ")"}], "-", 
                RowBox[{"muk", " ", "muq"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "-", 
                  RowBox[{"muk", "^", "2"}]}], "]"}], " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "-", 
                  RowBox[{"muq", "^", "2"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
          " ", "//", "Simplify"}], "//", "Expand"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"End", "[", "]"}], " ", "\[IndentingNewLine]", " ", "\n", 
   RowBox[{"EndPackage", "[", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.928913245660314*^9, 3.928913270075155*^9}, 
   3.928914211005808*^9, {3.928914465043487*^9, 3.92891448907544*^9}, 
   3.928917049171198*^9, {3.9289172269820232`*^9, 3.928917227679083*^9}, {
   3.928917351518887*^9, 3.9289173935100594`*^9}, {3.928917631507191*^9, 
   3.92891764244085*^9}, {3.928917714507627*^9, 3.9289177468993807`*^9}, 
   3.928918770640507*^9, {3.928918872551463*^9, 3.928918875546245*^9}, {
   3.928919390482688*^9, 3.928919397258267*^9}, 3.928919521148243*^9, 
   3.928919657443914*^9, {3.928919692227288*^9, 3.928919694634823*^9}, {
   3.9289199510669537`*^9, 3.928919957951536*^9}, {3.928920287866156*^9, 
   3.9289202897352552`*^9}, 3.928921310652446*^9, {3.928921433795651*^9, 
   3.928921453482857*^9}, 3.928921504234899*^9, {3.928921743596644*^9, 
   3.928921749142826*^9}, 3.928921804249832*^9, 3.92892219407193*^9, 
   3.9289226135378428`*^9, {3.928922669296931*^9, 3.928922681395617*^9}, 
   3.9308148946817408`*^9},ExpressionUUID->"dbb02b15-8348-4515-bba6-\
c3d8943c5d7d"],

Cell[BoxData["\<\"util`\"\>"], "Output",
 CellChangeTimes->{
  3.928913429236992*^9, 3.928913495480749*^9, 3.928914223494473*^9, 
   3.928914492024446*^9, 3.928914812919804*^9, 3.928917050808654*^9, 
   3.928917230208533*^9, 3.928917398509418*^9, 3.928917644127876*^9, 
   3.928917718442474*^9, 3.928917753963241*^9, 3.928918037239427*^9, 
   3.928919535815312*^9, 3.928919584299221*^9, 3.9289196594197187`*^9, 
   3.928919698961193*^9, 3.928920038037418*^9, {3.928920293162444*^9, 
   3.92892029456736*^9}, {3.928921460714258*^9, 3.928921462604643*^9}, 
   3.9289215084896593`*^9, 3.928921807129384*^9, 3.928922196242147*^9, 
   3.928922616890807*^9, 3.9289226831426897`*^9},
 CellLabel->
  "Out[890]=",ExpressionUUID->"bbeb43a8-5139-46f4-aea4-4fc55df23d57"],

Cell[BoxData["\<\"util`Private`\"\>"], "Output",
 CellChangeTimes->{
  3.928913429236992*^9, 3.928913495480749*^9, 3.928914223494473*^9, 
   3.928914492024446*^9, 3.928914812919804*^9, 3.928917050808654*^9, 
   3.928917230208533*^9, 3.928917398509418*^9, 3.928917644127876*^9, 
   3.928917718442474*^9, 3.928917753963241*^9, 3.928918037239427*^9, 
   3.928919535815312*^9, 3.928919584299221*^9, 3.9289196594197187`*^9, 
   3.928919698961193*^9, 3.928920038037418*^9, {3.928920293162444*^9, 
   3.92892029456736*^9}, {3.928921460714258*^9, 3.928921462604643*^9}, 
   3.9289215084896593`*^9, 3.928921807129384*^9, 3.928922196242147*^9, 
   3.928922616890807*^9, 3.9289226831540747`*^9},
 CellLabel->
  "Out[892]=",ExpressionUUID->"a4f4b72b-4e6b-4e05-809f-50bd25227da9"],

Cell[BoxData["\<\"util`Private`\"\>"], "Output",
 CellChangeTimes->{
  3.928913429236992*^9, 3.928913495480749*^9, 3.928914223494473*^9, 
   3.928914492024446*^9, 3.928914812919804*^9, 3.928917050808654*^9, 
   3.928917230208533*^9, 3.928917398509418*^9, 3.928917644127876*^9, 
   3.928917718442474*^9, 3.928917753963241*^9, 3.928918037239427*^9, 
   3.928919535815312*^9, 3.928919584299221*^9, 3.9289196594197187`*^9, 
   3.928919698961193*^9, 3.928920038037418*^9, {3.928920293162444*^9, 
   3.92892029456736*^9}, {3.928921460714258*^9, 3.928921462604643*^9}, 
   3.9289215084896593`*^9, 3.928921807129384*^9, 3.928922196242147*^9, 
   3.928922616890807*^9, 3.928922683217538*^9},
 CellLabel->
  "Out[895]=",ExpressionUUID->"3ef5616c-f3e1-416c-be4c-cd4b080c7b9c"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{693.75, 762},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a6c4f21a-396b-439d-8817-59d60dc6c0be"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5239, 123, 480, "Input",ExpressionUUID->"dbb02b15-8348-4515-bba6-c3d8943c5d7d",
 InitializationCell->True],
Cell[5822, 147, 759, 12, 33, "Output",ExpressionUUID->"bbeb43a8-5139-46f4-aea4-4fc55df23d57"],
Cell[6584, 161, 767, 12, 33, "Output",ExpressionUUID->"a4f4b72b-4e6b-4e05-809f-50bd25227da9"],
Cell[7354, 175, 765, 12, 33, "Output",ExpressionUUID->"3ef5616c-f3e1-416c-be4c-cd4b080c7b9c"]
}, Open  ]]
}
]
*)

